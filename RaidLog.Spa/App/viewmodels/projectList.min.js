define(["require","exports","services/dataService","services/routeFactory","plugins/router","viewmodels/pagedGrid","viewmodels/maintainProject"],function(n,t,i,r,u,f,e){var h=i,o=r,c=u,l=f,s=e;return function(){function n(){this.title="Projects",this.projects=ko.observableArray();var n={data:this.projects};this.listViewModel=new l.ListViewModel(n),this.listViewModel.searchPredicate=function(n,t){return t.code.indexOf(n)!==-1||t.name.indexOf(n)!==-1},this.canEditProject=this.canArchiveProject=ko.computed(function(){return this.listViewModel.selected()!==null},this)}return n.prototype.search=function(n){this.listViewModel.searchField(n)},n.prototype.activate=function(){this.refresh()},n.prototype.refresh=function(){var n=this;h.getProjects().done(function(t){$.each(t,function(n,t){t.projectRisksLink=o.makeProjectRiskLink(t.id),t.projectAssumptionsLink=o.makeProjectAssumptionLink(t.id),t.projectIssuesLink=o.makeProjectIssueLink(t.id),t.projectDependenciesLink=o.makeProjectDependencyLink(t.id),t.projectQueriesLink=o.makeProjectQueryLink(t.id)}),n.projects(t),n.listViewModel.setSelected(null)})},n.prototype.editProject=function(){var n=this,t=new s(this.listViewModel.selected());t.show().done(function(t){t&&n.refresh()})},n.prototype.newProject=function(){var n=this,t=new s(null);t.show().done(function(t){t&&n.refresh()})},n.prototype.archiveProject=function(){},n.prototype.viewRisks=function(n){c.navigateTo(n.projectRisksLink)},n}()})