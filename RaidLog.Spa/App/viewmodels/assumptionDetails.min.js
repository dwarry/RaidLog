var ds=require("./services/dataService"),_assumptionStatuses=ko.observableArray(),AssumptionDetails;ds.getReferenceData().done(function(n){_assumptionStatuses(n.assumptionStatuses)}),AssumptionDetails=function(){function n(n,t,i){var r=this;this.projectId=n,this._newItemCallback=i,this.id=0,this.version="",this.assumptionNumber=ko.observable(),this.description=ko.observable("").extend({required:!0,maxLength:2048}),this.workstream=ko.observable("").extend({require:!0,maxLength:50}),this.owner=ko.observable("").extend({maxLength:50}),this.validatedBy=ko.observable("").extend({maxLength:50}),this.statusId=ko.observable(null).extend({required:!0}),this.supportingDocumentation=ko.observable("").extend({maxLength:512}),this.assumptionStatuses=_assumptionStatuses,this.validation=ko.validatedObservable([this.description,this.workstream,this.owner,this.validatedBy,this.statusId,this.supportingDocumentation]),this.updateFromDto(t),this.canSave=ko.computed(function(){return r.validation.isValid()},this),this.status=ko.computed(function(){var n="(unknown)",t=r.statusId();return $.each(r.assumptionStatuses(),function(i,r){return r.id===t?(n=r.description,!1):!0}),n},this),this.validatedBy.extend({required:{onlyIf:function(){return r._isCurrentStatusFinal()}}}),this.supportingDocumentation.extend({required:{onlyIf:function(){return r._isCurrentStatusFinal()}}})}return n.prototype._isCurrentStatusFinal=function(){var n=!1,t=this.statusId();return $.each(this.assumptionStatuses(),function(i,r){return r.id===t?(n=r.isFinalState,!1):!0}),n},n.prototype.updateFromDto=function(n){this.id=n.id,this.version=n.version,this.assumptionNumber(n.assumptionNumber),this.description(n.description),this.workstream(n.workstream),this.owner(n.owner),this.validatedBy(n.validatedBy),this.statusId(n.statusId),this.supportingDocumentation(n.supportingDocumentation)},n.prototype.save=function(){var t=this,i={description:this.description(),workstream:this.workstream(),owner:this.owner(),validatedBy:this.validatedBy(),statusId:this.statusId(),supportingDocumentation:this.supportingDocumentation()},r=!this.id,n;r||(n=i,n.id=this.id,n.version=this.version,n.assumptionNumber=this.assumptionNumber(),n.projectId=this.projectId),ds.saveAssumption(this.projectId,i).done(function(n){t.updateFromDto(n),r&&t._newItemCallback(n)})},n}(),module.exports=AssumptionDetails